<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>

<!-- Sample/Pre-Made Wizzard-Friendly Mushclient Trigger Plugin File by Quow -->

<!-- To change colours of individual triggers, locate the trigger below and change the number given for the other_text_colour="x" option -->
<!-- To enable sounds for TPA breaks or EFF drops, scroll to the bottom of this file and uncomment (remove the two dashes) the playsound commands -->
<!-- Set the path for the sounds to a valid soundfile on your computer - I use a breaking glass sound for TPA, and a metal clunking noise for EFF drops, and a swishing/swooshing noise for FTF running out! -->

<muclient>
<plugin
   name="DiscTriggers"
   author="Quow"
   id="bff25408c325373fe3b17f4c"
   language="Lua"
   purpose="TriggersForDiscworld"
   date_written="2018-05-06"
   date_modified="2024-11-01"
   save_state="y"
   requires="4.84"
   version="0.08"
   >
</plugin>

<!--  Triggers  -->
<triggers>
   <!-- Each individual trigger appears between it's own <trigger> and </trigger> section, copy and paste an entire <trigger></trigger> section to make a new one, save the file, then reload your plugin to enable -->

   <!-- Set enabled to "n" to keep a trigger disabled without having to delete it, in case you want to re-enable at a later date -->

   <!-- Set keep_evaluating to "n" to stop any other trigger in this plugin from processing this line (doesn't stop/affect other plugins) -->

   <!-- Set other_text_colour to any ANSI colour name *OR* full hex-code, as seen in the colour picker in Mushclient if you press ctrl+alt+p -->
   <!-- You MUST keep custom_colour to 17, for other_text_colour to work, like this: -->
   <!-- custom_colour="17" -->
   <!-- other_text_colour="#9400D3" -->

   <!-- "Omit_from_output" can be set to "y" to stop the line appearing in your output window (eg to hide spam lines!) -->

   <!-- "Sequence" is like a priority order - lower sequence triggers process before higher sequence ones... -->
   <!--   Only important if you set "keep_evaluating" to "n", to stop one trigger from letting another, later trigger, from firing on that same line -->

   <!-- "regexp" should be set to "y" for all regexp triggers.  I make *ALL* my triggers be regexp, to allow me to help prevent false-positives/tells/talker chats triggering them.  Poke me if you want any help! -->
   <!--   Set regexp to "n" if you want standard non-regexp triggers (eg "plaintext", with "*" as a wildcard  -->
   <!--   ALL triggers in this file by default are regexp triggers, these allow matching start-of-line, end-of-line etc. to prevent talker chats or similar triggering them -->

   <!-- Triggers start below, comment above each says what it's for -->

   <!-- This trigger is for *YOUR* personal TPA/SFP breaking, lookup function "SoundPlayTPA" at bottom of this file to enable sound! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?There is a sudden white flash\.  Your magical shield has broken\.$"
   omit_from_output="n"
   sequence="10"
   script="SoundPlayTPA"
   regexp="y"
   make_bold="y"
   make_italic="n"
   make_underline="n"
  >
  </trigger>
  <!-- Note above the make_bold, make_italic, and make_underline codes - you can paste these into any trigger you want and set them to "y" -->
  

   <!-- This trigger is for SOMEONE ELSE TPA breaking, but it will helpfully ignore the "passing wizard" room chat outside the Drum! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?There is a sudden white flash around ((?!a passing wizard).+)\.$"
   omit_from_output="n"
   sequence="10"
   regexp="y"
  >
  </trigger>

  <!-- TPA changing colour to dull red, slight colour change -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="darkorange"
   match="^(?:> )?As your shield absorbs the impact, it becomes visible as a dull red glow\.$"
   omit_from_output="n"
   sequence="10"
   regexp="y"
  >
  </trigger>
  <!-- TPA changing colour to bright red, different colour change -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="orangered"
   match="^(?:> )?(As your shield absorbs the impact, it becomes visible as a bright red glow\.|As your shield absorbs the impact, its glow changes from a (.+?) to a bright red\.)$"
   omit_from_output="n"
   sequence="10"
   regexp="y"
  >
  </trigger>
  <!-- TPA changing colour to wobbling orange or flickering red, pick a bold/red colour change, almost broke! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?(As your shield absorbs the impact, it becomes visible as a (?>flickering yellow|wobbling orange)\.|As your shield absorbs the impact, its glow changes from a (.+?) to a (?>wobbling orange|flickering yellow)\.)$"
   omit_from_output="n"
   sequence="10"
   regexp="y"
  >
  </trigger>


  <!-- Two different events/triggers for bug-shield either flying away, or dying (may not cover all bug-shield events, I am not a witch!) -->
  <!-- Both of these can call the "SoundPlayTPA" script function at the bottom of this plugin file - uncomment the soundfile lines and put in a path for a valid .wav file for sound triggers on these -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?The (?>lacewings|stick insects|mayflies|praying mantids|butterflies|ladybirds|dragonflies|damselflies|moths|grasshoppers|winged termites|sandflies|mosquitoes|gnats|crickets|flying ants|locusts|horseflies|cicadas|bees|wasps|hornets|elephant beetles|assassin bugs) surrounding you scatter in different directions and fly off\.$"
   omit_from_output="n"
   sequence="10"
   regexp="y"
   script="SoundPlayTPA"
  >
  </trigger>
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?The last of the injured (?>lacewings|stick insects|mayflies|praying mantids|butterflies|ladybirds|dragonflies|damselflies|moths|grasshoppers|winged termites|sandflies|mosquitoes|gnats|crickets|flying ants|locusts|horseflies|cicadas|bees|wasps|hornets|elephant beetles|assassin bugs) surrounding you crash to the ground\.$"
   omit_from_output="n"
   sequence="10"
   regexp="y"
   script="SoundPlayTPA"
  >
  </trigger>

  <!-- Floater/EFF knockdown both message types, lookup function "SoundPlayEFF" to enable sound! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?(In blocking the attack (.+?) floating around you is knocked out of orbit\.|You realise that (.+?) is no longer floating around you\.)$"
   omit_from_output="n"
   sequence="10"
   script="SoundPlayEFF"
   regexp="y"
  >
  </trigger>

  <!-- Floater/EFF BROKE in mid-air!  Different colour to knockdown if you want, but call the EFF-knockdown sound function too -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="orangered"
   match="^(?:> )?(?P<effitem>(?:\w+\b\W*?){1,6}) floating around you breaks!$"
   omit_from_output="n"
   sequence="10"
   script="SoundPlayEFF"
   regexp="y"
  >
  </trigger>

  <!-- FETCH (reverse-portal) bloom appearing next to you -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="white"
   make_bold="y"
   match="^(?:> )?An? .+? arcane bloom sprouts from the ground here, growing rapidly to about knee height\.$"
   omit_from_output="n"
   sequence="25"
   regexp="y"
  >
  </trigger>

  <!-- Blorple ring vanishing from damage/failed casts on an un-repaired ring -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="orangered"
   match="^(?:> )?(?P<brokeblorp>(?:\w+\b\W*?){1,6}) disappears with a small pop of inrushing air\.$"
   omit_from_output="n"
   sequence="25"
   regexp="y"
  >
  </trigger>

  <!-- Burning JPCT portal - open/enter at own HP risk! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="orangered"
   match="^(?:> )?A burning (.+?) solidifies with a satisfying thump\.$"
   omit_from_output="n"
   sequence="25"
   regexp="y"
  >
  </trigger>

  <!-- Rumbling JPCT portal - cannot use, if you do you'll take a bunch of damage! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="orangered"
   match="^(?:> )?When you open (.+?) you think you can hear a faint rumbling sound from it\.$"
   omit_from_output="n"
   sequence="25"
   regexp="y"
  >
  </trigger>
  <!-- Maudlin Bridge Troll throw you off -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?The vibrations hurl you (?:across|off the side of|off) the bridge(.+)$"
   omit_from_output="n"
   sequence="25"
   regexp="y"
  >
  </trigger>
  <!-- Bad Mines -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?Something doesn't smell right\.  You take a sniff but the faint odour of rotten eggs makes you cough\.$"
   omit_from_output="n"
   sequence="25"
   regexp="y"
  >
  </trigger>
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?The air here is just as choking as before\.$"
   omit_from_output="n"
   sequence="25"
   regexp="y"
  >
  </trigger>
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?Somewhere above you, you hear the rumble of falling rock\.$"
   omit_from_output="n"
   sequence="25"
   regexp="y"
  >
  </trigger>
    <!-- Coffee Nostra hitman - sound-trigger function is "SoundPlayHitman" if you want to enable! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?A Coffee Nostra hitman steps out of the shadows\.$"
   omit_from_output="n"
   sequence="10"
   script="SoundPlayHitman"
   regexp="y"
  >
  </trigger>

  <!-- This is the line in the library when a new distortion is forming - make sure to "Look" after seeing this! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="darkgoldenrod"
   match="^(?:> )?You notice an odd rippling in the air\.$"
   omit_from_output="n"
   sequence="10"
   regexp="y"
  >
  </trigger>


  <!-- This is the distortions in the library - avoid moving into them! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?There is a strange distortion in space and time (.+?) you!$"
   omit_from_output="n"
   sequence="10"
   regexp="y"
  >
  </trigger>

  <!-- The alchemy guild is about to blow up - time to get out! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?The Alchemists' Guild begins to shudder, as if some experiment is about to go critical\.$"
   omit_from_output="n"
   sequence="10"
   regexp="y"
  >
  </trigger>

  <!-- Somebody/a mugger NPC snatch/filch items from you, filthy thieves -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?(.+?) grabs (.+?) from you\.  You struggle briefly but (.+?) wrests it from your grip and makes for a hasty retreat\.$"
   omit_from_output="n"
   sequence="20"
   regexp="y"
  >
  </trigger> 
  <!-- Hogswatch Christmas Tree hulk smash -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?The enraged giant Hogswatch tree smashes (.+?) out of your hands onto the ground( causing some of the liquid to splash out)?\.$"
   omit_from_output="n"
   sequence="20"
   regexp="y"
  >
  </trigger> 
  <!-- More snatchings -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?([^(\[])([^:]+) (?>suddenly grabs|snatches) your (.+) and makes a run for it\.$"
   omit_from_output="n"
   sequence="20"
   regexp="y"
  >
  </trigger> 
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?([A-Za-z](?:\w+\b\W*?){1,9}) snatches (.+?) from you\.$"
   omit_from_output="n"
   sequence="20"
   regexp="y"
  >
  </trigger> 
  <!-- Mugger dropping a snatched item on death -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?As (.+?) dies (.+?) drops (.+) in shock\.$"
   omit_from_output="n"
   sequence="100"
   regexp="y"
  >
  </trigger> 
  <!-- Drowning and/or sinking type texts -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?Despite your best efforts, your weight drags you down\.$"
   omit_from_output="n"
   sequence="100"
   regexp="y"
  >
  </trigger>
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="#D1EF01"
   match="^(?:> )?Your lungs feel a bit heavy\.$"
   omit_from_output="n"
   sequence="100"
   regexp="y"
  >
  </trigger> 
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="#E7CB0A"
   match="^(?:> )?Your lungs feel very heavy\.$"
   omit_from_output="n"
   sequence="100"
   regexp="y"
  >
  </trigger> 
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="#E6730B"
   match="^(?:> )?Your lungs feel close to bursting\.$"
   omit_from_output="n"
   sequence="100"
   regexp="y"
  >
  </trigger> 
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="#EA2806"
   match="^(?:> )?You feel a burning sensation in your lungs\.$"
   omit_from_output="n"
   sequence="100"
   regexp="y"
  >
  </trigger> 
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?Agonising pain radiates from your lungs\.$"
   omit_from_output="n"
   sequence="100"
   regexp="y"
  >
  </trigger> 
  <!-- WARNING!  Fumbling items! -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?(?>Whoops!  You tried to carry too many things and fumbled |Oops, butterfingers, you have dropped |You juggle your things, dropping ).+$"
   omit_from_output="n"
   sequence="20"
   regexp="y"
  >
  </trigger> 

  <!-- A cloud/FNOP minion fumbling stuff -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="red"
   match="^(?:> )?(.+?) cloud juggles around its stuff and fumbles (.+?)\.$"
   omit_from_output="n"
   sequence="100"
   regexp="y"
  >
  </trigger> 

  <!-- "Lassitude" interrupts spellcasting - caused by pragi'ing when a mail frog or bug-reply insect appears! :( -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="darkcyan"
   match="^(?:> )?A wave of lassitude comes over you and you lose interest in what you were doing\.$"
   omit_from_output="n"
   sequence="20"
   regexp="y"
  >
  </trigger>

  <!-- T-Shop door appearing on a wall!  -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="darkcyan"
   match="^(?:> )?Greasy sparks crawl over the (.+?) wall, and a door silently materialises\.$"
   omit_from_output="n"
   sequence="20"
   regexp="y"
  >
  </trigger>

  <!-- FTF spell effect ending - calls function "SoundPlayFTF" if you want to enable/edit in a sound for this ending -->
  <trigger
   enabled="y"
   keep_evaluating="n"
   custom_colour="17"
   colour_change_type="1"
   other_text_colour="mediumorchid"
   match="^(?:> )?Your feet touch the ground again\.$"
   omit_from_output="n"
   sequence="20"
   script="SoundPlayFTF"
   regexp="y"
  >
  </trigger>

  <!-- Omitting a couple of spam lines in one trigger, as an example - this trigger is DISABLED, it is just here for example! -->
  <!-- Set enabled="y" to enable it if you really want to omit these two particular sample-spam lines being omitted -->
  <trigger
   enabled="n"
   keep_evaluating="n"
   match="^(?:> )?(Trying to hurt a cloud of water vapour, are we\?|A huge trumpeting noise comes from your rear, closely followed by a stench of boiled cabbage\.)$"
   omit_from_output="y"
   sequence="50"
   regexp="y"
  >
  </trigger>

</triggers>

<script>
<![CDATA[

-- If you want to change the COLOURS of triggers, do so in the appropriate trigger section higher up this file, the other_text_colour option!

-- Below are four functions that can PLAY SOUNDFILES on your PC, commented out by default.  
-- Remove the two -- dashes before the appropriate "Sound" command to enable
-- Make sure the path and file name to a soundfile are valid!

-- Sound volume is a decibel change.  It MUST be from 0 to -100 (that's zero through to NEGATIVE one hundred)
-- As it's a decibel change, even -2 can cut the volume in half.  -10 is approximately a fifth of the full volume
-- Leave at 0 if you want sounds played at full volume
iSoundVolume = -10

-- ***** Self-TPA Breaking Sound *****
-- Uncomment the "PlaySound" command, and edit in a path to your own soundfile, to enable!
function SoundPlayTPA(name, line, wildcards, styles)

  --PlaySound (1, "C:/Discworld/glassbreak.wav", false, iSoundVolume, 0)

  -- IMPORTANT:  The path must use FORWARD SLASHES ONLY, instead of backward slashes!
  -- The first 1 is a "sound channel" - this means other sounds in different channels can play at the same time (eg a TPA sound while an EFF sound plays)
end

-- ***** Self-EFF Knockdown/Broken Sound *****
-- Uncomment the "PlaySound" command, and edit in a path to your own soundfile, to enable!
function SoundPlayEFF(name, line, wildcards, styles)

  --PlaySound (2, "C:/Discworld/clunking.wav", false, iSoundVolume, 0)

  -- IMPORTANT:  The path must use FORWARD SLASHES ONLY, instead of backward slashes!
  -- The first 2 is a "sound channel" - this means other sounds in different channels can play at the same time
end

-- ***** FTF Ending Sound *****
-- Uncomment the "PlaySound" command, and edit in a path to your own soundfile, to enable!
function SoundPlayFTF(name, line, wildcards, styles)

  --PlaySound (3, "C:/Discworld/swoosh.wav", false, iSoundVolume, 0)

  -- IMPORTANT:  The path must use FORWARD SLASHES ONLY, instead of backward slashes!
  -- The first 3 is a "sound channel" - this means other sounds in different channels can play at the same time
end

-- ***** Coffee Hitman Sound *****
-- Uncomment the "PlaySound" command, and edit in a path to your own soundfile, to enable!
function SoundPlayHitman(name, line, wildcards, styles)

  --PlaySound (4, "C:/Discworld/incoming.wav", false, iSoundVolume, 0)

  -- IMPORTANT:  The path must use FORWARD SLASHES ONLY, instead of backward slashes!
  -- The first 4 is a "sound channel" - this means other sounds in different channels can play at the same time
end

]]>
</script> 

</muclient>